# ãƒãƒƒãƒ—ã‚»ãƒ¬ã‚¯ãƒˆ
function ShuffledMap(debug:boolean=false):
    set {_check} to true
    set {_check} to false if {selected_map::*} is set
    set {_check} to true if {_debug} is true
    {_check} is true:
        if size of {map::*} = 0:
            add "01|Garry's Mod|ç©ºå³¶" to {map::*}
            add "02|Minecraft|ãƒ´ã‚£ãƒ©" to {map::*}
            add "03|CoD: Black Ops|ãƒ‹ãƒ¥ãƒ¼ã‚¯ã‚¿ã‚¦ãƒ³" to {map::*}
            add "04|Rainbow Six Siege|ã‚ªãƒ¬ã‚´ãƒ³" to {map::*}
        set {_map} to random element out of {map::*}
        set {selected_map::*} to {_map} split at "|"
        remove {_map} from {map::*}
    {_debug} is true:
        send "&8&o - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to ops
        send "&8&o  next: &7%{selected_map::3}%" to ops
        send "&8&o - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to ops

# ã‚²ãƒ¼ãƒ å‡¦ç†
command /s <number=0> <string="DM">:
    trigger:
        Resets()
        wait a tick
        if arg-1 is -1:
            {game} is set
            clear {game}
            execute console command "/team remove player"
            execute console command "/bossbar remove timer"
            execute console command "/worldborder set 300 0"
            execute console command "/worldborder warning distance 0"
            # å‹åˆ©ã‚¿ã‚°ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
            switch {winner}:
                case "n" -> set {winner} to "&8&lãªã—"
                case "â™¥" -> set {winner} to "&4&lãƒãƒ¼ãƒˆâ™¥"
                case "â™¦" -> set {winner} to "&4&lãƒ€ã‚¤ãƒ¤â™¦"
                case "â™£" -> set {winner} to "&f&lã‚¯ãƒ©ãƒ–â™£"
                case "â™ " -> set {winner} to "&f&lã‚¹ãƒšãƒ¼ãƒ‰â™ "
                case "ğŸƒ" -> set {winner} to "&8&lã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒ"
            # ã¾ã¨ã‚ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†
            send coloured "<#cd853f> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to players
            send coloured "<#cd853f>" to players
            send coloured "<#cd853f>  &7&lå‹åˆ©ãƒãƒ¼ãƒ ï¼š &f&l%{winner}%" to players
            send coloured "<#cd853f>" to players
            send coloured "<#cd853f>" to players
            loop {â™ ::*}:
                send coloured "<#cd853f>  &fã‚¹ãƒšãƒ¼ãƒ‰â™ ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} is "&fã‚¹ãƒšãƒ¼ãƒ‰â™ "
                send coloured "<#cd853f>  &7ã‚¹ãƒšãƒ¼ãƒ‰â™ ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} isn't "&fã‚¹ãƒšãƒ¼ãƒ‰â™ "
            loop {â™¥::*}:
                send coloured "<#cd853f>  &fãƒãƒ¼ãƒˆâ™¥ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} is "&4ãƒãƒ¼ãƒˆâ™¥"
                send coloured "<#cd853f>  &7ãƒãƒ¼ãƒˆâ™¥ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} isn't "&4ãƒãƒ¼ãƒˆâ™¥"
            loop {â™¦::*}:
                send coloured "<#cd853f>  &fãƒ€ã‚¤ãƒ¤â™¦ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} is "&4ãƒ€ã‚¤ãƒ¤â™¦"
                send coloured "<#cd853f>  &7ãƒ€ã‚¤ãƒ¤â™¦ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} isn't "&4ãƒ€ã‚¤ãƒ¤â™¦"
            loop {â™£::*}:
                send coloured "<#cd853f>  &fã‚¯ãƒ©ãƒ–â™£ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} is "&fã‚¯ãƒ©ãƒ–â™£"
                send coloured "<#cd853f>  &7ã‚¯ãƒ©ãƒ–â™£ï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} isn't "&fã‚¯ãƒ©ãƒ–â™£"
            loop {ğŸƒ::*}:
                send coloured "<#cd853f>  &fã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} is "&8ã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒ"
                send coloured "<#cd853f>  &7ã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒï¼š %loop-value% &8(%{skill_%loop-value's name%}%)" to players if {winner} isn't "&8ã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒ"
            send coloured "<#cd853f>" to players
            send coloured "<#cd853f> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to players
            # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãŠç‰‡ä»˜ã‘
            loop players:
                Reset(loop-player)
                teleport loop-player at location(0,100,0,"world")
            execute console command "/effect give @a minecraft:blindness 1 255 true"
            send title {winner} with subtitle "&7ãƒãƒ¼ãƒ ãŒå‹åˆ©ã—ã¾ã—ãŸ" to players for 4 second
            play sound "MUSIC_CREATIVE" with seed 20 with volume 0.3 with pitch 2 for players
            clear {â™ ::*}, {â™¥::*}, {â™¦::*}, {â™£::*}, {ğŸƒ::*}
            # ãƒãƒƒãƒ—ã®ãŠç‰‡ä»˜ã‘
            # set {_map} to a new cuboid region from location(-200,-64,-200,"world") to location(200,319,200,"world")
            # use we to set blocks in {_map} to "air"
        else if arg-1 is 1: 
            {game} isn't set
            set {game} to arg-2
            set {winner} to "n"
            execute console command "/team add player"
            execute console command "/worldborder warning distance 1000"
            execute console command "/team modify player color dark_red"
            execute console command "/team modify player collisionRule always"
            execute console command "/team modify player nametagVisibility never"
            execute console command "/team modify player seeFriendlyInvisibles false"
            execute console command "/bossbar add timer ""------------------------"""
            ShuffledMap()
#             paste schematic named "%{selected_map::1}%" at location(0,100,0):
#                 paste entities: true
#                 paste biomes: true
#                 ignore air: true
            add all items to {_items::*}
            # set {_test} to true if size of players is 1
            send coloured "<#cd853f> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to players
            send coloured "<#cd853f>" to players
            send coloured "<#cd853f>  &7ãƒãƒƒãƒ—ï¼š &f%{selected_map::3}% &8(%{selected_map::2}%)" to players
            send coloured "<#cd853f>" to players
            loop players:
                send coloured "<#cd853f>  &7å‚åŠ è€…%loop-counter%ï¼š &f%loop-value%" to players
            send coloured "<#cd853f>" to players
            if arg-2 is "DM": #Deathmatch
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™ A" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¥A" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¦A" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™£A" to {_cards::*}
                loop 9 times:
                    add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™ %loop-number +1%" to {_cards::*}
                    add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¥%loop-number +1%" to {_cards::*}
                    add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¦%loop-number +1%" to {_cards::*}
                    add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™£%loop-number +1%" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™ J" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¥J" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¦J" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™£J" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™ Q" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¥Q" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¦Q" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™£Q" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™ K" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¥K" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&4â™¦K" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&fâ™£K" to {_cards::*}
                add paper named "&7ãƒˆãƒ©ãƒ³ãƒ—ã®&8ğŸƒ" to {_cards::*}
                add {skill::*} to {_skill::*}
                loop players:
                    Reset(loop-player,"play")
                    set {_card} to random element out of {_cards::*}
                    set {_skill} to random element out of {_skill::*}
                    send subtitle "&8&oé•ã†ãƒãƒ¼ã‚¯ã®é™£å–¶ã‚’å…¨æ»…ã•ã›ã¾ã—ã‚‡ã†" to loop-player for 4 second
                    set slot 0 of loop-player's inventory to ({_skill})
                    set slot 1 of loop-player's inventory to (1 of bow or crossbow)
#                     set slot 2 of loop-player's inventory to (random integer between 20 and 30 of (random element out of {food::*}))
                    set slot 3 of loop-player's inventory to (1 of potion of strong instant health)
                    set slot 4 of loop-player's inventory to (1 of potion of strong instant health)
                    set slot 5 of loop-player's inventory to (random integer between 1 and 10 of (random element out of {_items::*}))
                    set slot 6 of loop-player's inventory to (random integer between 1 and 10 of (random element out of {_items::*}))
                    set slot 7 of loop-player's inventory to (random integer between 20 and 30 of arrow)
                    set slot 8 of loop-player's inventory to {_card}
                    execute console command "/team join player %loop-player%"
                    add loop-player to {â™ ::*} if {_card}'s name contains "â™ "
                    add loop-player to {â™¥::*} if {_card}'s name contains "â™¥"
                    add loop-player to {â™¦::*} if {_card}'s name contains "â™¦"
                    add loop-player to {â™£::*} if {_card}'s name contains "â™£"
                    add loop-player to {ğŸƒ::*} if {_card}'s name contains "ğŸƒ"
                    set {skill_%loop-player's name%} to uncolored name of {_skill}
                    subtract {_card} from {_cards::*}
                send coloured "<#cd853f>" to players
                loop {ğŸƒ::*}:
                    send title "&7&lã‚ãªãŸã¯&8&lã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒ&7&lã§ã™" to loop-value
                    send coloured "<#cd853f>  &7&lã‚ãªãŸã¯&8&lã‚¸ãƒ§ãƒ¼ã‚«ãƒ¼ğŸƒ&7&lé™£å–¶ã§ã™" to loop-value
                loop {â™ ::*}:
                    send title "&7&lã‚ãªãŸã¯&f&lã‚¹ãƒšãƒ¼ãƒ‰â™ &7&lã§ã™" to loop-value
                    send coloured "<#cd853f>  &7&lã‚ãªãŸã¯&f&lã‚¹ãƒšãƒ¼ãƒ‰â™ &7&lé™£å–¶ã§ã™" to loop-value
                loop {â™¥::*}:
                    send title "&7&lã‚ãªãŸã¯&4&lãƒãƒ¼ãƒˆâ™¥&7&lã§ã™" to loop-value
                    send coloured "<#cd853f>  &7&lã‚ãªãŸã¯&4&lãƒãƒ¼ãƒˆâ™¥&7&lé™£å–¶ã§ã™" to loop-value
                loop {â™¦::*}:
                    send title "&7&lã‚ãªãŸã¯&4&lãƒ€ã‚¤ãƒ¤â™¦&7&lã§ã™" to loop-value
                    send coloured "<#cd853f>  &7&lã‚ãªãŸã¯&4&lãƒ€ã‚¤ãƒ¤â™¦&7&lé™£å–¶ã§ã™" to loop-value
                loop {â™£::*}:
                    send title "&7&lã‚ãªãŸã¯&f&lã‚¯ãƒ©ãƒ–â™£&7&lã§ã™" to loop-value
                    send coloured "<#cd853f>  &7&lã‚ãªãŸã¯&f&lã‚¯ãƒ©ãƒ–â™£&7&lé™£å–¶ã§ã™" to loop-value
                send coloured "<#cd853f>" to players
                send coloured "<#cd853f> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -" to players
                execute console command "/effect give @a minecraft:darkness 5 255 true"
                execute console command "/effect give @a blindness 5 255 true"
                execute console command "/effect give @a slowness 1 255 true"
                execute console command "/spreadplayers 0 0 10 200 false @a"
#                 execute console command "/playsound minecraft:event.mob_effect.raid_omen master @a ~ ~ ~ 0.2 0 0.2"
#                 execute console command "/playsound minecraft:event.mob_effect.trial_omen master @a ~ ~ ~ 0.6 0 0.6"
                execute console command "/bossbar set timer name ""&f&l%{selected_map::3}% &8&m &8&o Deathmatch"""
                execute console command "/bossbar set timer style notched_20"
                loop 12001 times:
                    wait a tick
                    stop if {game} isn't set
                    execute console command "/bossbar set timer players @a" if loop-counter is 50
                    execute console command "/bossbar set timer value %100 - (loop-counter - 1)/120%" if mod(loop-counter, 12) is 1
                    if mod(loop-counter,200) is 1:
                        loop-counter > 66#6
                        # {_test} isn't true
                        # loop players where [{play::*} contain input]:
                        #     add 1 to {_â™ } if {â™ ::*} contain loop-player
                        #     add 1 to {_â™¥} if {â™¥::*} contain loop-player
                        #     add 1 to {_â™¦} if {â™¦::*} contain loop-player
                        #     add 1 to {_â™£} if {â™£::*} contain loop-player
                        #     add 1 to {_ğŸƒ} if {ğŸƒ::*} contain loop-player
                        set {_â™ } to 0
                        set {_â™¥} to 0
                        set {_â™¦} to 0
                        set {_â™£} to 0
                        set {_ğŸƒ} to 0
                        loop players where [{play::*} contain input]:
                            if {â™ ::*} contain loop-player:
                                set {_â™ } to 1
                            else if {â™¥::*} contain loop-player:
                                set {_â™¥} to 1
                            else if {â™¦::*} contain loop-player:
                                set {_â™¦} to 1
                            else if {â™£::*} contain loop-player:
                                set {_â™£} to 1
                            else if {ğŸƒ::*} contain loop-player:
                                set {_ğŸƒ} to 1
                        if {_â™ } + {_â™¥} + {_â™¦} + {_â™£} = 0:
                            set {winner} to "ğŸƒ"
                        else if {_â™¥} + {_â™¦} + {_â™£} + {_ğŸƒ} = 0:
                            set {winner} to "â™ "
                        else if {_â™ } + {_â™¦} + {_â™£} + {_ğŸƒ} = 0:
                            set {winner} to "â™¥"
                        else if {_â™ } + {_â™¥} + {_â™£} + {_ğŸƒ} = 0:
                            set {winner} to "â™¦"
                        else if {_â™ } + {_â™¥} + {_â™¦} + {_ğŸƒ} = 0:
                            set {winner} to "â™£"
                        execute console command "/s -1 %arg-2%" if {winner} isn't "n"
                execute console command "/s -1 %arg-2%" if {_test} isn't true
        else:
            if {game} isn't set:
                execute sender command "/s 1 %arg-2%"
            else:
                execute sender command "/s -1 %arg-2%"
